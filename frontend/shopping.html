<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>ShopHub - Recommendation System</title>
<style>
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  }

  body {
    background: linear-gradient(135deg, #1a0a2e 0%, #2d1b4e 50%, #1a0a2e 100%);
    color: white;
    min-height: 100vh;
    position: relative;
    overflow-x: hidden;
  }

  body::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: 
      radial-gradient(circle at 20% 80%, rgba(138, 43, 226, 0.15) 0%, transparent 50%),
      radial-gradient(circle at 80% 20%, rgba(186, 85, 211, 0.1) 0%, transparent 50%);
    animation: pulseBackground 8s ease-in-out infinite;
    pointer-events: none;
  }

  @keyframes pulseBackground {
    0%, 100% { opacity: 0.5; }
    50% { opacity: 0.8; }
  }

  /* Navbar */
  .navbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1.2rem 3rem;
    background: rgba(26, 10, 46, 0.95);
    backdrop-filter: blur(20px);
    position: sticky;
    top: 0;
    z-index: 1000;
    border-bottom: 1px solid rgba(138, 43, 226, 0.4);
    box-shadow: 0 5px 30px rgba(0, 0, 0, 0.5);
  }

  .navbar h2 {
    margin: 0;
    font-size: 2.2rem;
    background: linear-gradient(135deg, #a855f7, #ec4899);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    font-weight: 800;
    letter-spacing: 2px;
    text-shadow: 0 2px 10px rgba(138, 43, 226, 0.5);
    position: relative;
  }

  .navbar h2::after {
    content: '';
    position: absolute;
    bottom: -5px;
    left: 0;
    width: 100%;
    height: 2px;
    background: linear-gradient(90deg, #a855f7, transparent);
    border-radius: 2px;
  }

  .nav-links {
    display: flex;
    align-items: center;
    gap: 1.5rem;
  }

  .nav-links button, .nav-links select, #searchInput {
    background: rgba(51, 30, 80, 0.8);
    color: white;
    border: 1px solid rgba(168, 85, 247, 0.2);
    padding: 0.8rem 1.5rem;
    border-radius: 12px;
    cursor: pointer;
    font-size: 1rem;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    backdrop-filter: blur(10px);
    position: relative;
    overflow: hidden;
  }

  .nav-links button::before, .nav-links select::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(168, 85, 247, 0.2), transparent);
    transition: left 0.5s ease;
  }

  .nav-links button:hover::before, .nav-links select:hover::before {
    left: 100%;
  }

  .nav-links button:hover, .nav-links select:hover, #searchInput:focus {
    background: rgba(75, 40, 110, 0.9);
    transform: translateY(-2px);
    border-color: rgba(168, 85, 247, 0.6);
    box-shadow: 0 8px 25px rgba(138, 43, 226, 0.3);
  }

  #searchInput {
    width: 280px;
    background: rgba(40, 20, 60, 0.9);
    border: 1px solid rgba(168, 85, 247, 0.3);
    padding: 0.9rem 1.5rem;
    font-size: 1rem;
    transition: all 0.3s ease;
  }

  #searchInput:focus {
    outline: none;
    border-color: #a855f7;
    box-shadow: 0 0 0 2px rgba(168, 85, 247, 0.3);
    background: rgba(50, 30, 70, 0.95);
  }

  /* Cart button */
  #cartBtn, #recommendationsBtn, #wishlistBtn {
    background: linear-gradient(135deg, #a855f7 0%, #ec4899 100%);
    color: white;
    font-weight: 700;
    font-size: 1.1rem;
    padding: 0.9rem 2rem;
    border-radius: 12px;
    border: none;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
    box-shadow: 0 8px 25px rgba(138, 43, 226, 0.5);
  }

  #cartBtn::before, #recommendationsBtn::before, #wishlistBtn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: left 0.6s ease;
  }

  #cartBtn:hover, #recommendationsBtn:hover, #wishlistBtn:hover {
    transform: translateY(-3px) scale(1.05);
    box-shadow: 0 15px 35px rgba(138, 43, 226, 0.7);
  }

  #cartBtn:hover::before, #recommendationsBtn:hover::before, #wishlistBtn:hover::before {
    left: 100%;
  }

  /* Products grid */
  .products-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 2rem;
    padding: 3rem;
    max-width: 1600px;
    margin: 2rem auto;
    position: relative;
    z-index: 1;
  }

  .product-card {
    cursor: pointer;
    position: relative;
    overflow: hidden;
    border-radius: 16px;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    background: rgba(40, 20, 60, 0.8);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(168, 85, 247, 0.2);
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
  }

  .product-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, rgba(168, 85, 247, 0.15), transparent);
    opacity: 0;
    transition: opacity 0.3s ease;
    z-index: 1;
    border-radius: 16px;
  }

  .product-card:hover::before {
    opacity: 1;
  }

  .product-card img {
    width: 100%;
    height: 250px;
    display: block;
    border-radius: 16px 16px 0 0;
    object-fit: cover;
    transition: transform 0.4s ease;
    background: #2d1b4e;
  }

  .product-card:hover {
    transform: translateY(-15px) scale(1.05);
    box-shadow: 
      0 25px 50px rgba(138, 43, 226, 0.4),
      0 0 0 1px rgba(168, 85, 247, 0.3);
    border-color: rgba(168, 85, 247, 0.6);
  }

  .product-card:hover img {
    transform: scale(1.1);
  }

  .product-info {
    padding: 1rem;
  }

  .product-title {
    font-weight: 600;
    font-size: 1rem;
    margin-bottom: 0.5rem;
    color: #fff;
    height: 40px;
    overflow: hidden;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
  }

  .product-price {
    color: #a855f7;
    font-weight: 700;
    font-size: 1.2rem;
    margin-bottom: 0.5rem;
  }

  .product-category {
    color: #c4b5fd;
    font-size: 0.85rem;
    margin-bottom: 0.5rem;
    text-transform: capitalize;
  }

  .add-to-cart, .add-to-wishlist, .remove-item {
    background: rgba(168, 85, 247, 0.2);
    color: #a855f7;
    border: 1px solid rgba(168, 85, 247, 0.4);
    padding: 0.5rem 1rem;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 600;
    width: 100%;
    transition: all 0.3s ease;
    margin-top: 0.5rem;
  }

  .add-to-cart:hover, .add-to-wishlist:hover {
    background: rgba(168, 85, 247, 0.4);
    transform: translateY(-2px);
  }

  .remove-item {
    background: rgba(239, 68, 68, 0.2);
    color: #ef4444;
    border-color: rgba(239, 68, 68, 0.4);
  }

  .remove-item:hover {
    background: rgba(239, 68, 68, 0.4);
  }

  .rating-badge {
    position: absolute;
    top: 12px;
    right: 12px;
    background: linear-gradient(135deg, #f59e0b, #fbbf24);
    color: white;
    padding: 0.4rem 0.8rem;
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 600;
    z-index: 2;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
    transition: all 0.3s ease;
  }

  .product-card:hover .rating-badge {
    transform: scale(1.1) rotate(5deg);
  }

  .quantity-badge {
    position: absolute;
    top: 12px;
    left: 12px;
    background: linear-gradient(135deg, #a855f7, #ec4899);
    color: white;
    padding: 0.4rem 0.8rem;
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 600;
    z-index: 2;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
  }

  /* Loading spinner */
  .loading {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 300px;
    font-size: 1.5rem;
    color: #a855f7;
  }

  .spinner {
    width: 40px;
    height: 40px;
    border: 4px solid rgba(168, 85, 247, 0.3);
    border-radius: 50%;
    border-top-color: #a855f7;
    animation: spin 1s linear infinite;
    margin-right: 1rem;
  }

  @keyframes spin {
    to { transform: rotate(360deg); }
  }

  /* Floating animation for cards */
  @keyframes float {
    0%, 100% { transform: translateY(0px); }
    50% { transform: translateY(-10px); }
  }

  .product-card:nth-child(odd) {
    animation: float 6s ease-in-out infinite;
  }

  .product-card:nth-child(even) {
    animation: float 6s ease-in-out infinite 1s;
  }

  /* Responsive Design */
  @media (max-width: 1200px) {
    .products-grid {
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      gap: 1.5rem;
      padding: 2rem;
    }
  }

  @media (max-width: 1024px) {
    .products-grid {
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 1.5rem;
      padding: 2rem;
    }
  }

  @media (max-width: 768px) {
    .navbar {
      padding: 1rem 1.5rem;
      flex-direction: column;
      gap: 1rem;
    }

    .nav-links {
      flex-wrap: wrap;
      justify-content: center;
    }

    #searchInput {
      width: 200px;
    }

    .products-grid {
      grid-template-columns: repeat(auto-fill, minmax(170px, 1fr));
      gap: 1rem;
      padding: 1.5rem;
    }
  }

  @media (max-width: 480px) {
    .navbar h2 {
      font-size: 1.8rem;
    }

    .nav-links {
      gap: 1rem;
    }

    .nav-links button, .nav-links select, #searchInput {
      padding: 0.7rem 1rem;
      font-size: 0.9rem;
    }

    #searchInput {
      width: 150px;
    }

    .products-grid {
      grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      padding: 1rem;
    }

    .product-card img {
      height: 180px;
    }
  }
</style>
</head>
<body>

<div class="navbar">
  <h2>ShopHub</h2>
  <div class="nav-links">
    <button id="recommendationsBtn">üéØ Recommendations</button>
    <button id="wishlistBtn">üíù Wishlist</button>
    <button id="cartBtn">üõí Cart (<span id="cartCount">0</span>)</button>
    <select id="categorySelect" onchange="loadCategoryProducts(this.value)">
      <option value="">All Categories</option>
    </select>
    <input type="text" id="searchInput" placeholder="Search products..." oninput="filterProducts()"/>
  </div>
</div>

<div class="products-grid" id="productsGrid">
  <div class="loading">
    <div class="spinner"></div>
    Loading products...
  </div>
</div>

<script>
// Using DummyJSON API for real products
const API_URL = 'https://dummyjson.com/products';
const PRODUCTS_PER_PAGE = 80;
let allProducts = [];
let categories = [];
let currentCategory = 'all';
let currentView = 'products'; // 'products', 'cart', 'wishlist', 'recommendations'

// Initialize categories
async function initCategories() {
  const categorySelect = document.getElementById('categorySelect');
  
  try {
    const res = await fetch(`${API_URL}/categories`);
    const data = await res.json();
    categories = data;
    
    categories.forEach(cat => {
      const option = document.createElement('option');
      option.value = cat.slug;
      option.textContent = cat.name;
      categorySelect.appendChild(option);
    });
  } catch (error) {
    console.error('Error loading categories:', error);
    const fallbackCategories = [
      'smartphones', 'laptops', 'tablets', 'monitors',
      'fragrances', 'skincare', 'groceries', 
      'home-decoration', 'furniture', 'lighting',
      'mens-shirts', 'womens-dresses', 'womens-shoes', 
      'mens-shoes', 'womens-watches', 'mens-watches'
    ];
    fallbackCategories.forEach(cat => {
      const option = document.createElement('option');
      option.value = cat;
      option.textContent = cat.split('-').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');
      categorySelect.appendChild(option);
    });
  }
}

// Load products by category
async function loadProducts(category) {
  currentCategory = category;
  currentView = 'products';
  const productsGrid = document.getElementById('productsGrid');
  productsGrid.innerHTML = '<div class="loading"><div class="spinner"></div>Loading products...</div>';
  
  try {
    let url;
    if (category === 'all') {
      url = `${API_URL}?limit=${PRODUCTS_PER_PAGE}`;
    } else {
      url = `${API_URL}/category/${category}?limit=${PRODUCTS_PER_PAGE}`;
    }
    
    const res = await fetch(url);
    const data = await res.json();
    
    if (data.products && Array.isArray(data.products)) {
      allProducts = data.products.map(product => ({
        ...product,
        price: `$${product.price.toFixed(2)}`,
        rating: product.rating ? product.rating.toFixed(1) : '4.0'
      }));
      displayProducts(allProducts);
    } else {
      throw new Error('No products found');
    }
  } catch (error) {
    console.error('Error loading products:', error);
    productsGrid.innerHTML = '<div class="loading">Error loading products. Please try again.</div>';
    
    setTimeout(() => {
      loadMockProducts(category);
    }, 1000);
  }
}

// Fallback mock data
function loadMockProducts(category) {
  const mockProducts = generateMockProducts(category);
  allProducts = mockProducts;
  displayProducts(allProducts);
}

// Generate diverse mock products
function generateMockProducts(category) {
  const products = [];
  const categories = {
    electronics: [
      'iPhone 15 Pro', 'Samsung Galaxy S24', 'MacBook Pro M3', 'Dell XPS 15',
      'iPad Air', 'Sony WH-1000XM5', 'Apple Watch Series 9', 'Samsung OLED TV',
      'PlayStation 5', 'Xbox Series X', 'Nintendo Switch OLED', 'AirPods Pro',
      'GoPro Hero 12', 'Canon EOS R5', 'DJI Mini 4 Pro', 'Razer Blade 15'
    ],
    clothing: [
      'Premium Cotton T-Shirt', 'Designer Jeans', 'Leather Jacket', 'Summer Dress',
      'Running Sneakers', 'Winter Coat', 'Casual Hoodie', 'Formal Shirt'
    ],
    home: [
      'Modern Sofa', 'Dining Table Set', 'Queen Size Bed', 'Bookshelf',
      'Coffee Table', 'Office Chair', 'Wall Art', 'Floor Lamp'
    ]
  };
  
  const brands = {
    electronics: ['Apple', 'Samsung', 'Sony', 'Microsoft', 'Dell', 'LG'],
    clothing: ['Nike', 'Adidas', 'Levi\'s', 'H&M', 'Zara', 'Puma'],
    home: ['IKEA', 'West Elm', 'Crate & Barrel', 'Pottery Barn']
  };
  
  const cat = category || 'electronics';
  const categoryItems = categories[cat] || categories.electronics;
  const categoryBrands = brands[cat] || brands.electronics;
  
  for (let i = 1; i <= PRODUCTS_PER_PAGE; i++) {
    const item = categoryItems[Math.floor(Math.random() * categoryItems.length)];
    const brand = categoryBrands[Math.floor(Math.random() * categoryBrands.length)];
    
    products.push({
      id: i,
      title: `${brand} ${item}`,
      price: `$${(Math.random() * 1000 + 50).toFixed(2)}`,
      category: cat,
      rating: (Math.random() * 2 + 3).toFixed(1),
      thumbnail: `https://picsum.photos/300/200?random=${i}&category=${cat}`,
      brand: brand,
      stock: Math.floor(Math.random() * 100) + 10
    });
  }
  
  return products;
}

// Display products
function displayProducts(productsToShow) {
  const grid = document.getElementById('productsGrid');
  grid.innerHTML = '';
  
  productsToShow.slice(0, PRODUCTS_PER_PAGE).forEach(product => {
    const card = document.createElement('div');
    card.className = 'product-card';
    card.innerHTML = `
      <img src="${product.thumbnail || product.image || `https://picsum.photos/300/200?random=${product.id}`}" 
           alt="${product.title}" 
           onerror="this.src='https://picsum.photos/300/200?random=${product.id}'">
      <div class="rating-badge">‚≠ê ${product.rating || '4.0'}</div>
      <div class="product-info">
        <div class="product-title">${product.title}</div>
        <div class="product-price">${product.price}</div>
        <div class="product-category">${product.category || 'General'}</div>
        <button class="add-to-cart" onclick="addToCart(${product.id}, event)">Add to Cart</button>
        <button class="add-to-wishlist" onclick="addToWishlist(${product.id}, event)">üíù Wishlist</button>
      </div>
    `;
    card.addEventListener('click', (e) => {
      if (!e.target.classList.contains('add-to-cart') && !e.target.classList.contains('add-to-wishlist')) {
        window.location.href = `product.html?id=${product.id}&category=${product.category}`;
      }
    });
    grid.appendChild(card);
  });
}

// Load by selected category
function loadCategoryProducts(category) {
  if (!category) {
    loadProducts('all');
  } else {
    loadProducts(category);
  }
}

// Filter products
function filterProducts() {
  const query = document.getElementById('searchInput').value.toLowerCase();
  if (!query.trim()) {
    displayProducts(allProducts);
    return;
  }
  
  const filtered = allProducts.filter(product => 
    product.title.toLowerCase().includes(query) ||
    (product.brand && product.brand.toLowerCase().includes(query)) ||
    (product.category && product.category.toLowerCase().includes(query))
  );
  
  const grid = document.getElementById('productsGrid');
  if (filtered.length === 0) {
    grid.innerHTML = '<div class="loading">No products found. Try a different search term.</div>';
  } else {
    displayProducts(filtered);
  }
}

// Cart functionality
let cart = JSON.parse(localStorage.getItem('cart') || '[]');
let wishlist = JSON.parse(localStorage.getItem('wishlist') || '[]');

function updateCartCount() {
  document.getElementById('cartCount').textContent = cart.length;
}

function addToCart(productId, event) {
  if (event) event.stopPropagation();
  
  let product = allProducts.find(p => p.id === productId);
  
  if (!product) {
    product = wishlist.find(p => p.id === productId);
  }
  
  if (product) {
    const existingItem = cart.find(item => item.id === productId);
    
    if (existingItem) {
      existingItem.quantity = (existingItem.quantity || 1) + 1;
    } else {
      cart.push({
        id: product.id,
        title: product.title,
        price: product.price,
        image: product.thumbnail || product.image,
        quantity: 1,
        category: product.category,
        rating: product.rating
      });
    }
    
    localStorage.setItem('cart', JSON.stringify(cart));
    updateCartCount();
    
    const btn = event.target;
    const originalText = btn.textContent;
    btn.textContent = '‚úì Added';
    btn.style.background = '#a855f7';
    btn.style.color = 'white';
    setTimeout(() => {
      btn.textContent = originalText;
      btn.style.background = '';
      btn.style.color = '';
    }, 1000);
  }
}

function addToWishlist(productId, event) {
  if (event) event.stopPropagation();
  
  const product = allProducts.find(p => p.id === productId);
  if (product) {
    const existingItem = wishlist.find(item => item.id === productId);
    
    if (!existingItem) {
      wishlist.push({
        id: product.id,
        title: product.title,
        price: product.price,
        image: product.thumbnail || product.image,
        category: product.category,
        rating: product.rating
      });
      
      localStorage.setItem('wishlist', JSON.stringify(wishlist));
      
      const btn = event.target;
      const originalText = btn.textContent;
      btn.textContent = 'üíù Added';
      btn.style.background = '#ec4899';
      btn.style.color = 'white';
      setTimeout(() => {
        btn.textContent = originalText;
        btn.style.background = '';
        btn.style.color = '';
      }, 1000);
    }
  }
}

function removeFromCart(productId, event) {
  if (event) event.stopPropagation();
  
  // Find the index of the item to remove
  const itemIndex = cart.findIndex(item => item.id === productId);
  
  if (itemIndex !== -1) {
    // Remove the item from cart
    cart.splice(itemIndex, 1);
    
    // Save to localStorage
    localStorage.setItem('cart', JSON.stringify(cart));
    updateCartCount();
    
    // Show visual feedback
    const btn = event.target;
    const originalText = btn.textContent;
    btn.textContent = '‚úì Removed';
    btn.style.background = 'rgba(34, 197, 94, 0.4)';
    btn.style.color = 'white';
    
    // Refresh the cart view after a short delay
    setTimeout(() => {
      showCart();
    }, 300);
  }
}

function removeFromWishlist(productId, event) {
  if (event) event.stopPropagation();
  
  // Find the index of the item to remove
  const itemIndex = wishlist.findIndex(item => item.id === productId);
  
  if (itemIndex !== -1) {
    // Remove the item from wishlist
    wishlist.splice(itemIndex, 1);
    
    // Save to localStorage
    localStorage.setItem('wishlist', JSON.stringify(wishlist));
    
    // Show visual feedback
    const btn = event.target;
    const originalText = btn.textContent;
    btn.textContent = '‚úì Removed';
    btn.style.background = 'rgba(34, 197, 94, 0.4)';
    btn.style.color = 'white';
    
    // Refresh the wishlist view after a short delay
    setTimeout(() => {
      showWishlist();
    }, 300);
  }
}

// Clear entire cart
function clearCart() {
  if (confirm('Are you sure you want to clear your entire cart?')) {
    cart = [];
    localStorage.setItem('cart', JSON.stringify(cart));
    updateCartCount();
    showCart();
  }
}

// Show cart with products
function showCart() {
  currentView = 'cart';
  // Reload cart from localStorage
  cart = JSON.parse(localStorage.getItem('cart') || '[]');
  const grid = document.getElementById('productsGrid');
  
  if (cart.length === 0) {
    grid.innerHTML = '<div class="loading">Your cart is empty. Add some products!</div>';
    return;
  }
  
  grid.innerHTML = '<h2 style="grid-column: 1/-1; text-align: center; margin: 2rem 0; color: #a855f7;">üõí Your Cart</h2>';
  
  let total = 0;
  cart.forEach(item => {
    // Extract numeric price
    let price = 0;
    if (typeof item.price === 'string') {
      price = parseFloat(item.price.replace(/[^0-9.-]+/g, ''));
    } else {
      price = item.price;
    }
    
    total += price * (item.quantity || 1);
    
    const card = document.createElement('div');
    card.className = 'product-card';
    card.innerHTML = `
      <img src="${item.image || `https://picsum.photos/300/200?random=${item.id}`}" alt="${item.title}">
      ${item.quantity > 1 ? `<div class="quantity-badge">Qty: ${item.quantity}</div>` : ''}
      <div class="rating-badge">‚≠ê ${item.rating || '4.0'}</div>
      <div class="product-info">
        <div class="product-title">${item.title}</div>
        <div class="product-price">${item.price} ${item.quantity > 1 ? `x ${item.quantity}` : ''}</div>
        <div class="product-category">${item.category || 'General'}</div>
        <button class="remove-item" onclick="removeFromCart(${item.id}, event)">üóëÔ∏è Remove</button>
      </div>
    `;
    // Make card clickable but prevent click when clicking remove button
    card.addEventListener('click', (e) => {
      if (!e.target.classList.contains('remove-item')) {
        window.location.href = `product.html?id=${item.id}&category=${item.category}`;
      }
    });
    grid.appendChild(card);
  });
  
  const totalCard = document.createElement('div');
  totalCard.style.cssText = `
    grid-column: 1/-1;
    text-align: center;
    margin: 2rem auto;
    padding: 2rem;
    background: rgba(40, 20, 60, 0.8);
    border-radius: 16px;
    border: 1px solid rgba(168, 85, 247, 0.4);
  `;
  totalCard.innerHTML = `
    <h3 style="color: #a855f7; margin-bottom: 1rem;">Cart Total: $${total.toFixed(2)}</h3>
    <button onclick="loadProducts('all')" style="
      padding: 1rem 2rem;
      background: linear-gradient(135deg, #a855f7, #ec4899);
      color: white;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      font-size: 1rem;
      font-weight: 600;
      box-shadow: 0 8px 25px rgba(138, 43, 226, 0.5);
      transition: all 0.3s ease;
      margin-right: 1rem;
    " onmouseover="this.style.transform='translateY(-2px) scale(1.05)'; this.style.boxShadow='0 15px 35px rgba(138, 43, 226, 0.7)';" onmouseout="this.style.transform=''; this.style.boxShadow='0 8px 25px rgba(138, 43, 226, 0.5)';">‚Üê Continue Shopping</button>
    <button onclick="clearCart()" style="
      padding: 1rem 2rem;
      background: linear-gradient(135deg, #ef4444, #f97316);
      color: white;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      font-size: 1rem;
      font-weight: 600;
      box-shadow: 0 8px 25px rgba(239, 68, 68, 0.5);
      transition: all 0.3s ease;
    " onmouseover="this.style.transform='translateY(-2px) scale(1.05)'; this.style.boxShadow='0 15px 35px rgba(239, 68, 68, 0.7)';" onmouseout="this.style.transform=''; this.style.boxShadow='0 8px 25px rgba(239, 68, 68, 0.5)';">üóëÔ∏è Clear Cart</button>
  `;
  grid.appendChild(totalCard);
}

// Show wishlist
function showWishlist() {
  currentView = 'wishlist';
  // Reload wishlist from localStorage
  wishlist = JSON.parse(localStorage.getItem('wishlist') || '[]');
  const grid = document.getElementById('productsGrid');
  
  if (wishlist.length === 0) {
    grid.innerHTML = '<div class="loading">Your wishlist is empty. Add products to your wishlist!</div>';
    return;
  }
  
  grid.innerHTML = '<h2 style="grid-column: 1/-1; text-align: center; margin: 2rem 0; color: #ec4899;">üíù Your Wishlist</h2>';
  
  wishlist.forEach(item => {
    const card = document.createElement('div');
    card.className = 'product-card';
    card.innerHTML = `
      <img src="${item.image || `https://picsum.photos/300/200?random=${item.id}`}" alt="${item.title}">
      <div class="rating-badge">‚≠ê ${item.rating || '4.0'}</div>
      <div class="product-info">
        <div class="product-title">${item.title}</div>
        <div class="product-price">${item.price}</div>
        <div class="product-category">${item.category || 'General'}</div>
        <button class="add-to-cart" onclick="addToCart(${item.id}, event)">üõí Add to Cart</button>
        <button class="remove-item" onclick="removeFromWishlist(${item.id}, event)">üóëÔ∏è Remove</button>
      </div>
    `;
    card.addEventListener('click', (e) => {
      if (!e.target.classList.contains('add-to-cart') && !e.target.classList.contains('remove-item')) {
        window.location.href = `product.html?id=${item.id}&category=${item.category}`;
      }
    });
    grid.appendChild(card);
  });
  
  const backBtn = document.createElement('button');
  backBtn.textContent = '‚Üê Back to Shopping';
  backBtn.style.cssText = `
    grid-column: 1/-1;
    margin: 2rem auto;
    padding: 1rem 2rem;
    background: linear-gradient(135deg, #a855f7, #ec4899);
    color: white;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    font-size: 1rem;
    font-weight: 600;
    box-shadow: 0 8px 25px rgba(138, 43, 226, 0.5);
    transition: all 0.3s ease;
  `;
  backBtn.onmouseover = function() {
    this.style.transform = 'translateY(-2px) scale(1.05)';
    this.style.boxShadow = '0 15px 35px rgba(138, 43, 226, 0.7)';
  };
  backBtn.onmouseout = function() {
    this.style.transform = '';
    this.style.boxShadow = '0 8px 25px rgba(138, 43, 226, 0.5)';
  };
  backBtn.onclick = () => loadProducts('all');
  grid.appendChild(backBtn);
}

// Recommendations functionality
function getRecommendations() {
  if (cart.length === 0) {
    alert('Add some items to your cart to get personalized recommendations!');
    return;
  }
  
  currentView = 'recommendations';
  const cartCategories = [...new Set(cart.map(item => item.category))];
  const recommendedProducts = allProducts.filter(product => 
    cartCategories.includes(product.category) && 
    !cart.some(item => item.id === product.id)
  ).slice(0, 20);
  
  if (recommendedProducts.length === 0) {
    alert('No recommendations available. Try adding more items to your cart.');
    return;
  }
  
  const grid = document.getElementById('productsGrid');
  grid.innerHTML = '<h2 style="grid-column: 1/-1; text-align: center; margin: 2rem 0; color: #a855f7;">üéØ Recommended For You</h2>';
  
  recommendedProducts.forEach(product => {
    const card = document.createElement('div');
    card.className = 'product-card';
    card.innerHTML = `
      <img src="${product.thumbnail || product.image}" alt="${product.title}">
      <div class="rating-badge">‚≠ê ${product.rating}</div>
      <div class="product-info">
        <div class="product-title">${product.title}</div>
        <div class="product-price">${product.price}</div>
        <div class="product-category">${product.category}</div>
        <button class="add-to-cart" onclick="addToCart(${product.id}, event)">Add to Cart</button>
        <button class="add-to-wishlist" onclick="addToWishlist(${product.id}, event)">üíù Wishlist</button>
      </div>
    `;
    card.addEventListener('click', (e) => {
      if (!e.target.classList.contains('add-to-cart') && !e.target.classList.contains('add-to-wishlist')) {
        window.location.href = `product.html?id=${product.id}&category=${product.category}`;
      }
    });
    grid.appendChild(card);
  });
  
  const backBtn = document.createElement('button');
  backBtn.textContent = '‚Üê Back to All Products';
  backBtn.style.cssText = `
    grid-column: 1/-1;
    margin: 2rem auto;
    padding: 1rem 2rem;
    background: linear-gradient(135deg, #a855f7, #ec4899);
    color: white;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    font-size: 1rem;
    font-weight: 600;
  `;
  backBtn.onclick = () => displayProducts(allProducts);
  grid.appendChild(backBtn);
}

// Cart button
document.getElementById('cartBtn').addEventListener('click', showCart);

// Recommendations button
document.getElementById('recommendationsBtn').addEventListener('click', getRecommendations);

// Wishlist button
document.getElementById('wishlistBtn').addEventListener('click', showWishlist);

// Initialize
document.addEventListener('DOMContentLoaded', async () => {
  cart = JSON.parse(localStorage.getItem('cart') || '[]');
  wishlist = JSON.parse(localStorage.getItem('wishlist') || '[]');
  await initCategories();
  loadProducts('all');
  updateCartCount();
});
</script>

</body>
</html>